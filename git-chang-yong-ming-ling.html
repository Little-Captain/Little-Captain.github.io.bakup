<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Little Captain's Blog - git 常用命令</title>
    <meta name="description" content="">
    <meta name="author" content="Little Captain">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://littlecaptain.net/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://littlecaptain.net/theme/bootstrap.min.css" rel="stylesheet">
    <link href="http://littlecaptain.net/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="http://littlecaptain.net/theme/local.css" rel="stylesheet">
    <link href="http://littlecaptain.net/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="http://littlecaptain.net">Little Captain's Blog</a>

        <div class="nav-collapse">
        <ul class="nav">
            
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>git 常用命令</h1>
Sun 07 May 2017

by <a class="url fn" href="http://littlecaptain.net/author/little-captain.html">Little Captain</a>
 


        </div>
	
        <div><p><em>git核心命令工作示意图</em></p>
<p><img alt="" src="../assets/images/git/git常用命令-01.png"/></p>
<p><img alt="" src="../assets/images/git/git常用命令-02.png"/></p>
<p><img alt="" src="../assets/images/git/git常用命令-03.png"/></p>
<ul>
<li>git帮助</li>
</ul>
<div class="highlight"><pre><span></span>git <span class="nb">help</span> &lt;verb&gt;
git &lt;verb&gt; --help
man git-&lt;verb&gt;
git <span class="nb">help</span>
git <span class="nb">help</span> 其他指令
</pre></div>
<ul>
<li>初始化一个本地仓库，生成一个.git目录，用于维护版本信息</li>
</ul>
<div class="highlight"><pre><span></span># 初始化可以在一个空文件执行, 也可以在一个非空文件执行
git init
git init 仓库路径
# 初始化共享仓库, 共享仓库不能直接操作, 必须clone到本地
git init --bare
# Git 会自动修改该仓库目录的组权限为可写
git init --bare --shared
</pre></div>
<ul>
<li>克隆远程仓库到本地</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 下载远程仓库到当前路径</span>
git clone 仓库的URL
<span class="c1"># 下载远程仓库到特定路径</span>
git clone 仓库的URL 存放仓库的路径
<span class="c1"># 克隆时, 创建一个裸仓库(即一个不包含当前工作目录的仓库)</span>
git clone --bare my_project my_project.git
</pre></div>
<ul>
<li>下载远程仓库的最新信息到本地仓库, 注意它与git fetch的区别</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</span>
git pull
</pre></div>
<ul>
<li>将本地的仓库信息推送到远程仓库</li>
</ul>
<div class="highlight"><pre><span></span>git push
git push --force <span class="c1"># 强制推送</span>
</pre></div>
<ul>
<li>git仓库的忽略处理, 指定哪些文件不纳入版本库的管理. 把文件修改或者新添加的文件添加到暂存区域.  git add 命令使用文件或目录的路径作为参数; 如果参数是目录的路径，该命令将递归 地跟踪该目录下的所有文件</li>
</ul>
<div class="highlight"><pre><span></span>touch .gitignore <span class="c1"># 或使用已有的.gitignore文件</span>
git add .gitignore
git commit -m <span class="s2">"进行忽略操作"</span> .gitignore
</pre></div>
<p><em>.gitignore 格式规范</em></p>
<div class="highlight"><pre><span></span><span class="c1"># 所有空行或者以 # 开头的行都会被 Git 忽略。</span>
<span class="c1"># 可以使用标准的 glob 模式匹配。</span>
<span class="c1"># 匹配模式可以以(/)开头防止递归。</span>
<span class="c1"># 匹配模式可以以(/)结尾指定目录。</span>
<span class="c1"># 要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号(!)取反。</span>
</pre></div>
<blockquote>
<p>所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。 星号()匹配零个或多个任意字符;[abc] 匹配 任何一个列在方括号中的字符(这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c);问号(?)只匹配一个任意字符;如果在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配(比如 [0-9] 表示匹配所有 0 到 9 的数字)。 使用两个星号**示匹配任意中间目录，比如a/**/z 可以匹配 a/z, a/b/z 或 a/b/c/z等。</p>
</blockquote>
<ul>
<li>配置该仓库的用户名和邮箱</li>
</ul>
<div class="highlight"><pre><span></span>git config user.name "manager" 
git config user.email "manager@qq.com"
</pre></div>
<ul>
<li>配置全局用户名和邮箱</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">user</span><span class="p">.</span><span class="n">name</span> <span class="s">"Katie-Liu"</span>
<span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">user</span><span class="p">.</span><span class="n">name</span> <span class="s">"Katie-Liu@126.com"</span>
</pre></div>
<ul>
<li>配置文本编辑器</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 当Git需要你输入信息时会调用它, Git默认的是vim</span>
git config --global core.editor vim
</pre></div>
<ul>
<li>配置信息</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 查看当前所有配置信息</span>
git config -l <span class="c1"># list</span>
<span class="c1"># 编辑当前配置信息</span>
git config -e <span class="c1"># edit 使用vim</span>
<span class="c1"># 检查某一项配置</span>
git config user.name
</pre></div>
<ul>
<li>查看git仓库状态</li>
</ul>
<div class="highlight"><pre><span></span># 使用git status -s
XY
X shows the status of the index
Y shows the status of the work tree
For untracked paths, XY are ??
Other status codes can be interpreted as follows:
o   ' ' = unmodified
o   M = modified
o   A = added
o   D = deleted
o   R = renamed
o   C = copied
o   U = updated but unmerged
Ignored files are not listed, unless --ignored option is in effect, in which case XY are !!.
</pre></div>
<div class="highlight"><pre><span></span># 红色表示该文件并没有被git仓库管理, 还有其他可能的含义
# 绿色表示该文件已被添加到git的暂缓区中
git status
git status 文件名
git status -s
</pre></div>
<ul>
<li>使用git status -s显示状态的含义说明</li>
</ul>
<blockquote>
<p>新添加的未跟踪文件前面有 ?? 标记，新添加到暂存区中的文件前面有 A 标记，修改过的文件前面有 M 标记。 你可能注意到了 M 有两个可以出现的位置，出现在右边的 M 表示该文件被修改了但是还没放入暂存区，出现在 靠左边的 M 表示该文件被修改了并放入了暂存区。</p>
</blockquote>
<ul>
<li>总结: <code>左边</code>表示<code>暂存区</code>, <code>右边</code>表示<code>工作区</code></li>
<li>将工作区的文件添加到git仓库的暂缓区, 不管是新建文件还是修改了的文件, 都需要再次添加</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 跟文件名或文件夹名</span>
git add . <span class="c1"># 常用</span>
git add xxx
</pre></div>
<p><img alt="" src="../assets/images/git/git常用命令-04.png"/></p>
<ul>
<li>提交到本地git仓库, 把暂存区域的所有内容提交到当前分支,  每一次运行提交操作，都是对你项目作一次快照，以后可以回到这个状态，或者进行比较。</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># xxx 文件名或文件夹名, 也可以不写, 表示提交所有</span>
git commit -m <span class="s2">"注释"</span> xxx
<span class="c1"># 尽管使用暂存区域的方式可以精心准备要提交的细节，但有时候这么做略显繁琐。 Git 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 git commit 加上 -a 选项，Git 就会自动把所有已经跟踪过的文件暂存起 来一并提交，从而跳过 git add 步骤</span>
git commit -a -m <span class="s1">'注释'</span>
</pre></div>
<p><img alt="" src="../assets/images/git/git常用命令-05.png"/></p>
<ul>
<li>撤销操作</li>
</ul>
<blockquote>
<p>在任何一个阶段都有可能想要撤消某些操作。注 意，有些撤消操作是不可逆的。 这是在使用 Git 的过程中，会因为操作失误而导致之前的工作丢失的少有的几个地方之一。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="c1"># 提交完了才发现漏掉了几个文件没有添加，或者提交信息写错了。 此时，可以运行带有 --amend 选项的提交命令尝试重新提交. 这个命令会将暂存区中的文件提交。如果自上次提交以来你还未做任何修改(如果在上次提交后马上执行了此命令)，那么快照会保持不变，而你所修改的只是提交信息。只会有一个提交, 第二次提交将代替第一次提交的结果</span>
git commit --amend
</pre></div>
<ul>
<li>给git命令取别名</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 当前仓库别名</span>
git config alias.st <span class="s2">"status"</span> <span class="c1"># status--&gt;st</span>
git config alias.ci <span class="s2">"commit -m"</span> <span class="c1"># commit -m --&gt;ci</span>

<span class="c1"># 全局的别名</span>
git config --global alias.st <span class="s2">"status"</span>

<span class="c1"># 配置带颜色的log别名</span>
git config --global alias.lg <span class="s2">"log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit"</span>
</pre></div>
<ul>
<li>git中删除文件</li>
</ul>
<blockquote>
<p>要从 Git 中移除某个文件，就必须要从已跟踪文件清单中移除(确切地说，是从暂存区域移除)，然后提交。 可以用 git rm 命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清 单中了。
 如果删除之前修改过并且已经放到暂存区域的话，则必须要用强制删除选项 -f(译注:即 force 的首字母)。 这是一种安全特性，用于防止误删还没有添加到快照的数据，这样的数据不能被 Git 恢复。
 把文件从 Git 仓库中删除(亦即从暂存区域移除)，但仍然希望保留在当前工作目录 中。 换句话说，你想让文件保留在磁盘，但是并不想让 Git 继续跟踪。为达到这一目 的，使用 --cached 选项</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="c1"># 后跟文件名, 可以同时跟多个</span>
<span class="c1"># 删除只在工作区和暂缓去, 本地仓库并没有删除, 所以我们需要commit</span>
git rm xxx1 xxx2
<span class="c1"># 只删除仓库中的文件, 而保留工作目录中的</span>
git rm --cached xxx
<span class="c1"># git rm 命令后面可以列出文件或者目录的名字，也可以使用 glob 模式. 注意到星号 * 之前的反斜杠 \， 因为 Git 有它自己的文件模式扩展匹配方式，所以我们不用 shell 来帮忙展开。</span>
git rm log/<span class="se">\*</span>.log <span class="c1"># 删除 log/ 目录下扩展名为 .log 的所有文件</span>
git rm <span class="se">\*</span>~ <span class="c1"># 删除以 ~ 结尾的所有文件</span>
</pre></div>
<ul>
<li>移动文件</li>
</ul>
<blockquote>
<p>Git 并不显式跟踪文件移动操作. 如果在 Git 中重命名了某个文件，仓库中存储的元数据并不会体现出这是一次改名操作。 不过 Git能推断出究竟发生了什么.</p>
</blockquote>
<div class="highlight"><pre><span></span>git mv file_from file_to
<span class="c1"># 上面一条命令相当于下面三条</span>
mv file_from file_to
git rm file_from
git add file_to
<span class="c1"># 有时候用其他工具批处理改名的话，要记得在 提交前删除老的文件名，再添加新的文件名。</span>
</pre></div>
<ul>
<li>查看版本信息</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 查看版本信息(基本版) </span>
<span class="c1"># 按提交时间列出所有的更新，最近的更新排在最上面</span>
<span class="c1"># 版本号是一个由SHA1生成的哈希值</span>
git log
<span class="c1"># 查看指定文件的版本库日志</span>
git log 文件名
<span class="c1"># 查看最近的N次信息</span>
git log -N
<span class="c1"># 显示每次提交的内容差异, 当进行代码审查，或者快速浏览某个搭档提交的 commit 所带来的变化的时候，这个参数就非常有用了。</span>
git log -p
<span class="c1"># 看每次提交的简略的统计信息，可以使用 --stat 选项. --stat 选项在每次提交的下面列出额所有被修改过的文件、有多少文件被修改了以及被修改过 的文件的哪些行被移除或是添加了</span>
git log --stat
<span class="c1"># HEAD指向当前所在的分支, 可以简单地使用 git log 命令查看各个分支当前所指的对象。 提供这一功能的参数是 --decorate。</span>
git log --decorate
<span class="c1"># --graph, 引入图形显示方式</span>
git log --graph
git log --oneline --decorate --graph --all
<span class="c1"># --all, 显示所有提交历史</span>
git log --all
<span class="c1"># --pretty选项可以指定使用不同于默认格式的方式展示提交历史--pretty=[oneline short full fuller format]</span>
git log --pretty<span class="o">=</span>oneline
<span class="c1"># --pretty的子选项format，可以定制要显示的记录格式</span>
git log --pretty<span class="o">=</span>format:<span class="s2">"%h - %an, %ar : %s"</span>
<span class="c1"># 当 oneline 或 format 与另一个 log 选项 --graph 结合使用时尤其有用。 这个选项添加了一些ASCII字符串来形象地展示你的分支、合并历史</span>
git log --pretty<span class="o">=</span>format:<span class="s2">"%h %s"</span> --graph
<span class="c1"># 一个很实用的 git log 选项是路径(path)， 如果只关心某些文件或者目录的历史提交，可以在 git log 选 项的最后指定它们的路径。 因为是放在最后位置上的选项，所以用两个短划线(--)隔开之前的选项和后面限定 的路径名。</span>
<span class="c1"># 一个综合例子: 查看 Git 仓库中，2008 年 10 月期间，Junio Hamano 提交的但未合并的测试文件</span>
git log --pretty<span class="o">=</span><span class="s2">"%h - %s"</span> --author<span class="o">=</span>gitster --since<span class="o">=</span><span class="s2">"2008-10-01"</span> --before<span class="o">=</span><span class="s2">"2008-11-01"</span> --no-merges -- t/
<span class="c1"># 查看版本信息(加强版)</span>
<span class="c1"># 可以查看版本回退信息</span>
git reflog
</pre></div>
<p><em>git log --pretty=format 常用的选项</em></p>
<p><img alt="" src="../assets/images/git/git常用命令-06.png"/></p>
<p><em>git log 的常用选项</em></p>
<p><img alt="" src="../assets/images/git/git常用命令-07.png"/></p>
<p><em>限制git log输出的选项</em></p>
<p><img alt="" src="../assets/images/git/git常用命令-08.png"/></p>
<ul>
<li>查看改动, 想知道具体修改了什么地方，可以用 git diff 命令, git diff 将通过文件补丁的格式显示具体哪些行发生了改变</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 查看当前路径所有文件最新改动的地方</span>
<span class="c1"># 查看尚未暂存的文件更新了哪些部分</span>
<span class="c1"># 比较的是工作目录中当前文件和暂存区域快照之间的差异， 也就是修改之后还没有暂存起来的变化内容</span>
<span class="c1"># 只显示尚未暂存的改动，而不是自上次提交以来所做的所有改动</span>
git diff
<span class="c1"># 查看某个文件的最新改动的地方</span>
git diff 文件名
<span class="c1"># 查看已暂存的将要添加到下次提交里的内容</span>
<span class="c1"># 也就是比较暂存区和git仓库中的内容</span>
git diff --cached
git diff --staged <span class="c1"># Git 1.6.1及以上</span>
git diff --tool<span class="o">=</span>vimdiff <span class="c1"># 启动图形化差异分析工具</span>
<span class="c1"># emerge</span>
<span class="c1"># opendiff</span>
<span class="c1"># vimdiff</span>
<span class="c1"># vimdiff2</span>
<span class="c1"># vimdiff3</span>
<span class="c1"># 可以使用config的diff.tool属性, 指定默认分析工具</span>
</pre></div>
<ul>
<li>查看标签</li>
</ul>
<div class="highlight"><pre><span></span>git tag
</pre></div>
<ul>
<li>对当前版本打一个标签</li>
</ul>
<div class="highlight"><pre><span></span>git tag -a MOMO1.0 -m <span class="s2">"MOMO1.0"</span>
<span class="c1"># 将标签推送到远程代码库中</span>
git push origin MOMO1.0
</pre></div>
<ul>
<li>使用tag，就能够将项目快速切换到某一个中间状态，例如产品开发线上的某一个稳定版本</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 签出v1.0标签</span>
git checkout v1.0
<span class="c1"># 从检出状态创建v1.0bugfix分支</span>
git checkout -b bugfix1.0
<span class="c1"># 上面一条代码相当于: </span>
git branch bugfix1.0
git checkout bugfix1.0
</pre></div>
<ul>
<li>版本回退</li>
<li>
<ol>
<li>修改已经add到了暂存区, 但是这个修改还没有提交到版本库(取消修改). 例如，你已经修改了两个文件并且想要将它们作为两次独立的修改提交，但是却意外地输入了 git add * 暂存了它们两个。</li>
</ol>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 加上 --hard 选项可以令 git reset 成为一个危险的命令(可能导致工作目录中所有当前进度丢失!)，但这种情况跟工作目录内的文件并不会被修改。 不加选项地调用 git reset 并不危险, 它只会修改暂存区域。</span>
git reset HEAD fileName
</pre></div>
<ul>
<li>
<ol>
<li>本地仓库修改了内容,并且这个修改已经被提交到版本库(回退到以前的版本)</li>
</ol>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># 回退到上一个版本</span>
git reset --hard HEAD^
<span class="c1"># 回退到上N个版本</span>
git reset --hard HEAD~N
<span class="c1"># 回退到指向的任意版本</span>
git reset --hard 五位数字的版本号 <span class="c1">#当然多于5位也可</span>
</pre></div>
<ul>
<li>3.撤消对文件的修改. 如何方便地撤消修改, 将它还原成上次提交时的样子(或者刚克隆完的样子，或者刚把它放入工作目录时的样子)?</li>
</ul>
<div class="highlight"><pre><span></span>git checkout -- <span class="o">[</span>file<span class="o">]</span>
</pre></div>
<blockquote>
<p><code>重要</code>: git checkout -- [file] 是一个危险的命令。 你对那个文件做的任何修改都会消失, 只是拷贝了另一个文件来覆盖它。 除非你确实清楚不想要那个文件了，否则不要使用这个命令。记住，在 Git 中任何已提交的东西几乎总是可以恢复的。 甚至那些被删除的分支中的提交或使用 --amend 选项覆盖的提交也可以恢复。 然而，任何你未提交的东西丢失后很可能再也找不 到了。</p>
</blockquote></div>
	
        <hr>

    </div>
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="http://littlecaptain.net/archives.html">Archives</a>
                <li><a href="http://littlecaptain.net/tags.html">Tags</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                <li><a href="http://littlecaptain.net/category/c.html">C++</a></li>
                <li><a href="http://littlecaptain.net/category/git.html">git</a></li>
                <li><a href="http://littlecaptain.net/category/ios.html">iOS</a></li>
                <li><a href="http://littlecaptain.net/category/java.html">Java</a></li>
                <li><a href="http://littlecaptain.net/category/ji-suan-ji-wang-luo.html">计算机网络</a></li>
                <li><a href="http://littlecaptain.net/category/linux.html">Linux</a></li>
                <li><a href="http://littlecaptain.net/category/php.html">PHP</a></li>
                <li><a href="http://littlecaptain.net/category/pyqt.html">PyQt</a></li>
                <li><a href="http://littlecaptain.net/category/python.html">Python</a></li>
                <li><a href="http://littlecaptain.net/category/shell.html">shell</a></li>
                <li><a href="http://littlecaptain.net/category/svn.html">SVN</a></li>
                <li><a href="http://littlecaptain.net/category/tools.html">Tools</a></li>
                <li><a href="http://littlecaptain.net/category/xcode.html">Xcode</a></li>
                <li><a href="http://littlecaptain.net/category/za-tan.html">杂谈</a></li>
                <li><a href="http://littlecaptain.net/category/zheng-ze-biao-da-shi.html">正则表达式</a></li>
                   
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>
            
                <li><a href="https://github.com/Little-Captain">Github</a></li>
            </ul>
            </div>



        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="http://littlecaptain.net">Little Captain's Blog</a> &copy; Little Captain 2018</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://littlecaptain.net/theme/bootstrap-collapse.js"></script>
 
</body>
</html>